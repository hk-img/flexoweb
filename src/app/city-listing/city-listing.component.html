<div class="loader_circle">
  <span class="loader" *ngIf="isloader"></span>
</div>
<div
  [ngClass]="_showMap ? 'filter-wrapper style1 mar-top-100 half-map' : 'mt-70'"
>
  <div class="container-fluid position-relative" style="z-index: 99;">
    <div class="row">
      <div class="col-lg-7 col-md-12" [class.col-lg-12]="!_showMap">
        <filter-item
          [isMobile]="isMobile"
          [city_name]="city_param"
          find_near_me="0"
          area_name="0"
          is_city="true"
          [filter]="filter"
          [nearByLocations]="nearBySpaces.asObservable()"
          (filterItemEvent)="openFiltersDialog($event)"
          (showMap)="showHideMap($event)"
        >
        </filter-item>
        <div class="row pad-bot-10 align-items-center">
          <div class="col-lg-12 col-sm-12 col-12">
            <div
              class="item-element res-box text-right xs-left"
              *ngIf="shimming"
            >
              <div style="float: center">
                <app-shimmer-loading
                  [borderRadius]="'5px'"
                  [width]="'35%'"
                  [height]="'30px'"
                ></app-shimmer-loading>
              </div>
            </div>
            <div
              class="item-element res-box text-right xs-left"
              *ngIf="spaces_list.length"
            >
              <p *ngIf="page_start !== page_end">
                Showing
                <span
                  >{{ page_start }}-{{ page_end }} of {{ space_count }}</span
                >
                Listings
              </p>
              <p *ngIf="page_start == page_end">
                Showing
                <span>{{ page_start }} of {{ space_count }}</span> Listings
              </p>
            </div>
          </div>
        </div>
        <div class="item-wrapper">
          <div class="tab-content flex-shimmer" *ngIf="shimming">
            <div>
              <app-shimmer-loading
                [borderRadius]="'5px'"
                [width]="'100%'"
                [height]="'480px'"
              ></app-shimmer-loading>
            </div>
            <div>
              <app-shimmer-loading
                [borderRadius]="'5px'"
                [width]="'100%'"
                [height]="'480px'"
              ></app-shimmer-loading>
            </div>
          </div>
          <div style="text-align: center;" *ngIf="!spaces_list.length && !recommended_spaces.length && !isloader">
            <img style="width: 35%;" src="../../assets/images/not-found.jpg" alt="">
            <h3>Spaces not found!</h3>
          </div>
          <div
            class="tab-content"
            *ngIf="
              spaces_list.length
            "
          >
        
            <div  id="grid-view" class="tab-pane active product-grid">
              <div class="row">
                <div
                  class="col-lg-12"
                  *ngFor="let element of spaces_list"
                  [ngClass]="!_showMap ? 'col-xl-4' : 'col-xl-6'"
                >
                  <app-list-item
                    [spaceDetails]="element"
                    [isMobile]="isMobile"
                    [filters]="filter"
                    [is_similar_listing]="false"
                    (shortlistItemEvent)="shortList($event)"
                    (mouseover)="onHoverSpace(element.name)"
                    (mouseleave)="onLeaveSpace(element.name)"
                  >
                  </app-list-item>
                </div>
              </div>
            </div>
            <!--pagination starts-->
            <div class="post-nav nav-res pad-bot-80">
              <div class="row">
                <div class="col-md-8 offset-md-2 col-xs-12">
                  <div class="page-num text-center">
                    <ul>
                      <li
                        *ngFor="let num of pages"
                        [ngClass]="{ active: active_page == num }"
                        (click)="pagination(num)"
                      >
                        <a>{{ num }}</a>
                      </li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div
            class="tab-content"
            *ngIf="recommended_spaces?.length"
          >
            <div id="grid-view" class="tab-pane active product-grid">
              <span style="display: flex; justify-content: center">
                <p style="font-size: 30px; text-align: center">
                  We are adding more spaces.
                  <a class="static-page-links" routerLink="/contact"
                    >Join our mailing list</a
                  >
                  to get an update as we add spaces to your location.
                </p> </span
              ><br />
              <div class="row">
                <div
                  [ngClass]="!_showMap ? 'col-xl-4' : 'col-xl-6'"
                  *ngFor="let element of recommended_spaces"
                >
                  <app-list-item
                    [spaceDetails]="element"
                    [filters]="filter"
                    [is_similar_listing]="false"
                    (shortlistItemEvent)="shortList($event)"
                  >
                  </app-list-item>
                </div>
              </div>
            </div>
          </div>

          <div
            class="row desktop-button-fixed-container col-md-7"
            *ngIf="staticValue == 'private-office' || staticValue == 'shared-office' || staticValue == 'virtual-office' || staticValue == 'managed-office'"
          >
            <div class="col-md-7">
              <span
                ><i class="ion-checkmark"></i>&nbsp;Our service is
                <strong>FREE</strong></span
              ><span
                ><i class="ion-checkmark"></i>&nbsp;We help secure the
                <strong>best deal</strong></span
              >
            </div>
            <div class="col-md-5">
              <a
              (click)="openInquiryPopUp()"
                class="large-btn"
                style="font-size: 14px"
                >FIND MY PERFECT OFFICE NOW</a
              >
              <!-- [routerLink]="'/contact-form/' + city_param?.replace(' ', '-')" -->
            </div>
          </div>
        </div>
      </div>
      <div
        class="explore__map-side"
        [class.d-none]="!_showMap || isFaqsVisible"
        [@inOutAnimation]
      >
        <div id="map_right_listing" #map_section>
          <google-map
            height="100%"
            width="100%"
            [zoom]="zoom"
            [center]="center"
            [options]="options"
          >
            <map-marker
              #mapMarker="mapMarker"
              *ngFor="let marker of markersData"
              [position]="marker.position"
              [title]="marker.title"
              [options]="marker.options"
              (mapClick)="openMapInfoWindow(mapMarker, marker.info)"
            ></map-marker>
           
            <map-info-window>
              <div (click)="onSpaceNameClicked(selected_marker_window)" style="cursor: pointer;" id="marker_info">
                <span class="map_wishlist" [style.color]="selected_marker_window?.existingfavorite?.favourite ? '#F76900' : 'gray'"><i (click)="shortList(selected_marker_window,$event)" class="ion-heart scale_2"></i></span>
                <!-- <img [src]="selected_marker_window?.map_image_url" alt="" (error)="handleImageError($event)" width="320"/> -->
                <div class="position-relative max-width">
                <ngx-slick-carousel class="carousel" #slickMainCarousel="slick-carousel" [config]="mainSliderConfig"
                  responsive="breakpoints">
                  <ng-container *ngIf="selected_marker_window?.images?.length">
                    <div *ngFor="let image of selected_marker_window?.images" ngxSlickItem class="swiper-slide single-listing-slider slide">
                      <a style="cursor: pointer;">
                        <img [src]="image" (error)="handleImageError($event)" />
                      </a>
                    </div>
                  </ng-container>
                  <ng-container *ngFor="let repeat of getArray(selected_marker_window?.images?.length)">
                    <div *ngIf="!selected_marker_window?.images?.length" ngxSlickItem class="swiper-slide single-listing-slider slide">
                      <a style="cursor: pointer;">
                        <img src="assets/images/details_placeholder_image.jpg" />
                      </a>
                    </div>
                  </ng-container>
                </ngx-slick-carousel>
                <a class="carousel-control-prev cursor-pointer"   role="button" data-slide="prev" (click)="prev($event)">
                  <span class="icon ion-chevron-left icon-color"></span>
                </a>
                <a class="carousel-control-next cursor-pointer"   role="button" data-slide="next" (click)="next($event)">
                  <span class="icon ion-chevron-right icon-color"></span>
                </a>
              </div>
              <div class="info_window_content">
                <div class="row align-items-center justify-content-between">
                  <div [ngClass]="selected_marker_window?.rating ? 'col-8 pr-0' : 'col-12'"><h5 class="m-0" [ngClass]="selected_marker_window?.rating && 'text-truncate'" [title]="selected_marker_window?.name"  >{{selected_marker_window?.name}}</h5></div>
                  <div  *ngIf="selected_marker_window?.rating" class="col-4 pl-0 text-right "><h5 class="m-0 text-truncate" > <i class="ion ion-star"></i>{{selected_marker_window?.rating}} ({{selected_marker_window?.reviewCount}})</h5></div>
                </div>
                <div class="d-flex align-items-center mb-1" style="gap: 22px;">
                  <div *ngIf="mapType === 'coworking' || mapType === 'shortterm'  ">
                    <i class="fa fa-user" style="color: #f76900;"></i> &nbsp;{{selected_marker_window?.howManyPeopleInYourSpace}} people
                  </div>
                  <div *ngIf="mapType === 'longterm'">
                    <i class="fa-solid fa-house" style="color: #f76900;"></i> {{selected_marker_window?.spaceStatus}}
                  </div>
                  <div>
                    <svg xmlns="http://www.w3.org/2000/svg" enable-background="new 0 0 24 24" height="18" viewBox="0 0 24 24" width="18"
                      style="fill: #f76900;vertical-align: sub;">
                      <path d="m0 0h24v24h-24z" fill="none" />
                      <path
                        d="m17.66 17.66-1.06 1.06-.71-.71 1.06-1.06-1.94-1.94-1.06 1.06-.71-.71 1.06-1.06-1.94-1.94-1.06 1.06-.71-.71 1.06-1.06-1.95-1.95-1.06 1.06-.71-.71 1.06-1.06-1.94-1.94-1.06 1.06-.71-.71 1.06-1.06-2.34-2.34v14c0 1.1.9 2 2 2h14zm-10.66-.66v-5.76l5.76 5.76z" />
                    </svg>{{selected_marker_window?.spacesqft}} sqft
                  </div>
                </div>
                <div class="d-flex mt-2" style="gap:30px;align-items: baseline;">
                  <div *ngIf="mapType === 'shortterm' || mapType === 'longterm'">
                      <div class="m-0">
                        <img src="assets/images/rs-icon.png" class="rs_icon" alt="">
                        <span
                          class="price-value">{{selected_marker_window?.originalPrice}}</span>
                        <span> / {{mapType === 'shortterm' ? 'hour' : 'month' }}</span>
                      </div>
                  </div>
                <div *ngIf="selected_marker_window?.isInstant && mapType === 'shortterm'">
                  <i class="fa fa-bolt bolt_icon"></i><span class="instant_back p-1 text-dark">Instant Book</span>
                </div>
                <div *ngIf="selected_marker_window?.spaceStatus?.toLowerCase() === 'furnished' && mapType === 'longterm'">
                  <span class="status_back p-1 text-white"> {{selected_marker_window?.spaceStatus}}</span>
                </div>
              </div>
              <div *ngIf="mapType === 'coworking'">
                  <div class="m-0">
                    <img src="assets/images/rs-icon.png" class="rs_icon" alt="">
                    <span *ngIf="selected_marker_window.flexible_desk_price !== null" class="price-value">{{selected_marker_window?.privatecabin_price > selected_marker_window.flexible_desk_price ? selected_marker_window.flexible_desk_price: selected_marker_window.privatecabin_price }}</span>
                    <span *ngIf="selected_marker_window.flexible_desk_price == null" class="price-value">{{selected_marker_window?.privatecabin_price}}</span>
                    <small> / seat / month</small>
                  </div>
              </div>
              </div>
            </div>
            </map-info-window>
          </google-map>
        </div>
      </div>
    </div>
  </div>
  <div *ngIf="isMobile" class="bottom-fixed-container">
    <div class="find-office-container">
      <p class="booking-text">
        <i class="ion-checkmark"></i>&nbsp;Our service is <span>FREE</span>.
      </p>
      <p class="booking-text">
        <i class="ion-checkmark"></i>&nbsp;We help you secure the
        <span>best deals</span>.
      </p>
    </div>
    <div
      class="book-btn text-center bottom-fixed-button"
      style="margin-top: 3px"
    >
      <a
        style="font-size: 14px"
        [routerLink]="'/contact-form/' + city_param?.replace(' ', '-')"
        >FIND MY PERFECT OFFICE NOW</a
      >
    </div>
  </div>
  <app-faqs
    [showMap]="_showMap"
    #faqsChild
    inViewport
    [spaceType]="spaceType"
    [cityName]="city_param"
    [location]="areaName"
    [inViewportOptions]="{ threshold: [0] }"
    (inViewportAction)="onIntersection($event)"
  ></app-faqs>
</div>
